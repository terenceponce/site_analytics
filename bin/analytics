#!/usr/bin/env ruby
# frozen_string_literal: true

$LOAD_PATH.unshift(File.expand_path('../../lib', __FILE__))

require 'site_analytics'
require 'sequel'
DB = Sequel.connect('sqlite://database.db')

puts 'Analyzing log file...'
results = SiteAnalytics.execute(ARGV[0])
puts DB.table_exists?(:pages)

puts 'Results are in!'
puts ''
results.each do |key, value|
  puts "#{key} had #{value} visits"
end

puts ''
puts 'Finished analyzing log file!'
